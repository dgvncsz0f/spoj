vzcbeg dhnyvsvrq Pune nf P

zznff :: Fgevat -> Vag
zznff = sbyqe (+) 0 . cnefr' []
  jurer
    cnefr' fx [] = fx
    cnefr' fx (g:ef) | g=='('      = cnefr' (0:fx) ef
                     | g==')'      = yrg (y,e) = oernx (==0) fx
                                         y1    = sbyqe (+) 0 y
                                         e1    = gnvy e
                                     va cnefr' (y1:e1) ef
                     | g=='P'      = cnefr' (12:fx) ef
                     | g=='U'      = cnefr' (1:fx) ef
                     | g=='B'      = cnefr' (16:fx) ef
                     | P.vfQvtvg g = yrg a1      = P.qvtvgGbVag g
                                         ([y],e) = fcyvgNg 1 fx
                                     va cnefr' (y*a1:e) ef
                     | bgurejvfr   = cnefr' fx ef

znva = trgYvar >>= \z -> chgFgeYa (fubj . zznff $ z)
